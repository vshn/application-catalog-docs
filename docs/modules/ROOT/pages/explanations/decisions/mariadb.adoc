= VSHN Managed MariaDB

== Problem

We need to provide MariaDB on Kubernetes with following features:

* Standalone and Cluster functionality (Galera)
* Ability to customize MariaDB settings
* Included metrics exporter
* Backup
* Regular Maintenance
* Version Upgrades


== Solutions

For MariaDB there are a few operators available.
As well as the Bitnami Helm charts.

The following section contains the operators that have been looked at.

[cols="1,1,1,1"]
|===
|Requirements |https://github.com/abalki001/mariadb-operator[Official MariaDB Operator] |https://github.com/bitnami/charts/tree/master/bitnami/mariadb-galera[Bitnami Helmchart]| https://github.com/mariadb-operator/mariadb-operator[New Mariadb Operator]

|Galera and Standalone |❌ no galera |✅|✅Multi master, single master

|Customize MariaDB Settings |❌ |✅|✅

|Metrics |✅ |✅|✅

|Backup |✅ |❌|✅
|Automatic Restore |❌ |❌|✅

|Regular Maintenance |❌ |❌|❌

|Version Upgrades |✅ |✅|✅
|User management |❌ |❌|✅
|Logical Database Management |❌ |❌|✅

|===

Some additional Notes:

* The Galera Operator by Orange has been archived: https://github.com/Orange-OpenSource/galera-operator
* The Official Mariadb operator is linked here: https://mariadb.com/kb/en/kubernetes-operators-for-mariadb/
* Percona has a MySQL Operator: https://docs.percona.com/percona-operator-for-mysql/pxc/
* MOCO Operator (MySQL Only): https://github.com/cybozu-go/moco
** Has a similar concept to handling clustering like the Patroni framework that is used by Stackgres.
* New operator, independent from MariaDB project, MIT licensed:  https://github.com/mariadb-operator/mariadb-operator[New Mariadb Operator]

== Decision

https://github.com/mariadb-operator/mariadb-operator[New Mariadb Operator].

New operator is currently the best what github offers, comes with variety of installation methods and is actively maintained.

Advantages::

* Supports almost everything we need
* Easy to integrate with Appcat
* Actively maintained
* Advanced Galera support compared to Bitnami

Disadvantages::

* Lack of regular, automated maintenance

=== Rationale

Operators add one more layer of complexity to the setup and one more part that can break.
In order to justify this added complexity the operators should provide more functionality than a simple Helm Chart.

With experience from SPKS we know how the Bitnami Helm Chart works and that it's capable of satisfying our requirements.
